---
interface Props {
  url?: string;
}

const { url = 'https://shadcnblocks.com' } = Astro.props;
---

<div 
  id="promotional-banner" 
  class="bg-primary relative" 
  style="display: none;"
  data-banner-url={url}
>
  <div class="container flex items-center justify-between gap-4 py-3 pr-12">
    <div class="flex flex-1 items-center justify-center gap-3 sm:gap-4">
      <span class="text-primary-foreground text-center text-sm font-medium">
        Purchase this theme on{' '}
        <span class="font-semibold">shadcnblocks.com</span>
      </span>
      <a 
        href={url} 
        target="_blank"
        class="inline-flex h-8 items-center justify-center rounded-md bg-white/90 px-3 text-xs font-medium text-primary shadow-sm transition-colors hover:bg-white focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-white"
      >
        Get Template
      </a>
    </div>
    <button
      id="dismiss-banner"
      class="absolute top-1/2 right-4 -translate-y-1/2 rounded-sm p-1.5 text-primary-foreground/70 hover:text-primary-foreground transition-all duration-200 hover:scale-110 hover:bg-white/10 focus:ring-2 focus:ring-white/30 focus:outline-none"
      aria-label="Close banner"
    >
      <svg 
        xmlns="http://www.w3.org/2000/svg" 
        width="14" 
        height="14" 
        viewBox="0 0 24 24" 
        fill="none" 
        stroke="currentColor" 
        stroke-width="2" 
        stroke-linecap="round" 
        stroke-linejoin="round"
        class="size-3.5"
      >
        <path d="M18 6 6 18"/>
        <path d="m6 6 12 12"/>
      </svg>
    </button>
  </div>
</div>

<script>
  function isBannerDismissed(): boolean {
    if (typeof localStorage === 'undefined') return false;
    return localStorage.getItem('banner-dismissed') === 'true';
  }

  function initBanner() {
    const banner = document.getElementById('promotional-banner');
    if (!banner) return;

    if (!isBannerDismissed()) {
      banner.style.display = 'block';
    }
  }

  function handleDismiss() {
    const banner = document.getElementById('promotional-banner');
    if (!banner) return;

    banner.style.display = 'none';
    localStorage.setItem('banner-dismissed', 'true');
  }

  document.addEventListener('DOMContentLoaded', () => {
    initBanner();
    
    const dismissButton = document.getElementById('dismiss-banner');
    if (dismissButton) {
      dismissButton.addEventListener('click', handleDismiss);
    }
  });

  document.addEventListener('astro:page-load', () => {
    initBanner();
    
    const dismissButton = document.getElementById('dismiss-banner');
    if (dismissButton) {
      dismissButton.addEventListener('click', handleDismiss);
    }
  });
</script>
