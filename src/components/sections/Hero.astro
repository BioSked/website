---
import { Play } from 'lucide-astro';
import Button from '@/components/ui/Button.astro';
import { Image } from 'astro:assets';
import dateView from '@/assets/screenshots/dateview.png';
import mobileInHand from '@/assets/layout/mobilehand.png';
import cyanDust from '@/assets/layout/cyan-dust_background.webp';
import GroupIcon from '@/assets/layout/group2.svg';
import HospitalIcon from '@/assets/layout/hospital.svg';
import EarthIcon from '@/assets/layout/earth.svg';
---

<section class="section-padding relative">
  <div class="absolute inset-0 z-0 pointer-events-none">
    <div class="absolute top-1/4 right-0 size-[800px] bg-no-repeat" style={'background-image: url("'+cyanDust.src+'");'}></div>
    <!-- <div class="blob-accent absolute top-0 left-0 size-[700px] rounded-full opacity-25 blur-3xl dark:opacity-40 -translate-x-1/3 -translate-y-1/3"></div>
    <div class="blob-primary absolute top-1/4 right-0 size-[650px] rounded-full opacity-30 blur-3xl dark:opacity-55 translate-x-1/4"></div>
    <div class="blob-secondary absolute top-1/2 left-1/4 size-[550px] rounded-full opacity-20 blur-3xl dark:opacity-35"></div>
    <div class="blob-accent absolute bottom-1/4 right-1/3 size-[450px] rounded-full opacity-20 blur-3xl dark:opacity-35"></div> -->
  </div>
  
  <div class="container relative z-10">
    <div class="flex">
      <div class="flex max-w-[900px] flex-col gap-5 md:gap-6 flex-3">
        <h1 class="text-display-hero text-left">
          Smart staff scheduling for healthcare
          <!-- <br class="hidden md:block" /> -->
        </h1>
        
        <p class="max-w-[90%] text-lead">
          Create AI-powered, fair, compliant schedules 10x faster so teams can focus on care.
        </p>

        <div class="flex flex-wrap gap-2">
          <a href="/bookdemo">
            <Button
              size="lg"
              variant="default"
              className="rounded-full shadow-sm shadow-primary/50 hover:shadow-md px-5 font-bold ease-in-out transition-all scale-100 hover:scale-103 duration-200 border border-white/50"
              onclick="window.dispatchEvent(new CustomEvent('open-contact-sales'))"
            >
              Book a Demo
            </Button>
          </a>

          <Button
            size="lg"
            variant="ghost"
            className="rounded-full shadow-none font-semibold px-3 text-card-foreground hover:bg-card-foreground/5"
            id="see-how-it-works-btn"
          >
            &nbsp; Watch 1-minute tour
            <div class="bg-background/15 border-background/10 grid size-5.5 place-items-center rounded-full border">
              <Play class="size-4 mr-2 fill-primary/30" />
            </div>
          </Button>
        </div>
        <div class="font-semibold text-muted-foreground text-sm">
          <GroupIcon class="inline-block size-7 mb-1 mr-1"/>Trusted by 50,000+ daily users
          <span class="mx-2 font-light hidden lg:inline">|</span>
          <hr class="lg:hidden border-none mb-1">
          <HospitalIcon class="inline-block size-5 mb-1 mr-1"/>1,000+ healthcare sites
          <span class="mx-2 font-light hidden lg:inline">|</span>
          <hr class="lg:hidden border-none mb-2">
          <EarthIcon class="inline-block size-5 mb-1 mr-1"/>9 countries
        </div>
      </div>
      <div class="hidden sm:block flex-2">
        <Image 
          src={mobileInHand} 
          alt="MM Mobile"
          class="w-200"
        />
      </div>
    </div>

    <div id="hero-media-container" class="mx-auto mt-16 w-full max-w-[1000px] rounded-xl border border-border bg-background/45 p-2 shadow-[4px_2px_3rem_rgba(0,0,0,.15)] backdrop-blur-sm dark:shadow-[4px_2px_3rem_rgba(0,0,0,.5)] md:p-2">
      <Image
        id="hero-image"
        src={dateView}
        alt="Momentum healthcare scheduling software calendar interface showing physician schedules, shift management, and RVU tracking for medical practices"
        width={1000}
        height={563}
        widths={[640, 750, 828, 1000, 1500, 2000]}
        format="webp"
        quality={85}
        loading="eager"
        fetchpriority="high"
        class="w-full h-auto rounded-lg"
      />
      <div
        id="hero-video"
        class="w-full rounded-lg hidden aspect-video"
      >
      </div>
    </div>
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const btn = document.getElementById('see-how-it-works-btn');
    const container = document.getElementById('hero-media-container');
    const heroImage = document.getElementById('hero-image');
    const heroVideo = document.getElementById('hero-video');
    
    if (btn && container && heroImage && heroVideo) {
      let iframeCreated = false;
      
      btn.addEventListener('click', () => {
        container.scrollIntoView({ behavior: 'smooth', block: 'center' });
        
        setTimeout(() => {
          if (!iframeCreated) {
            const iframe = document.createElement('iframe');
            iframe.className = 'w-full h-full rounded-lg';
            iframe.src = 'https://www.youtube.com/embed/_DLDf09HXQ8?autoplay=1&muted=0&rel=0';
            iframe.title = 'How It Works';
            iframe.setAttribute('frameborder', '0');
            iframe.setAttribute('allow', 'accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture');
            iframe.setAttribute('allowfullscreen', '');
            heroVideo.appendChild(iframe);
            iframeCreated = true;
          }
          

          heroImage.classList.add('hidden');
          heroVideo.classList.remove('hidden');
        }, 300);
      });
    }
  });
</script>
